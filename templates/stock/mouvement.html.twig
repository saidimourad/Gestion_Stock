{% extends 'base.html.twig' %}

{% block title %}{% endblock %}

{% block body %}
    {# {% if (is_granted('ROLE_ADMIN') or is_granted('ROLE_DIRECTEUR')  or  is_granted('ROLE_CHEFBUREAU') or   is_granted('ROLE_CHEFUNITE') or  is_granted('ROLE_MAGASINIER')  ) %}

   <div class="row">
         <div class="col-lg-12">

         <div class="card card-info card-outline">
         <div class="card-header">
             <h3 class="card-title">
                 <i class="fas fa-list"></i>
                Mouvement des articles
             </h3>

             <div class="card-tools">
                 <button type="button" class="btn btn-tool" data-widget="maximize"><i class="fas fa-expand"></i>
                 </button>
             </div>

         <div class="panel-body">


         <div class="row mt-4" >
             <nav class="w-100 ">
                 <div class="nav nav-tabs" id="product-tab" role="tablist">
                     <a class="nav-item nav-link active" id="product-desc-tab" data-toggle="tab" href="#product-desc" role="tab" aria-controls="product-desc" aria-selected="true">Recherche par date</a>

                 </div>
             </nav>
             <div class="tab-content p-3" id="nav-tabContent">
                 <div class="tab-pane fade show active" id="product-desc" role="tabpanel" aria-labelledby="product-desc-tab">
                     <div class="card-body">
                          <form class="form-horizontal" method="post">
                                 <label>Date début: </label>
                                 <input name="min"  placeholder="Date début" id="min" type="text" autocomplete="off" >
                                 <label>Date fin : </label>
                                 <input name="max" placeholder="Date fin" id="max" type="text" autocomplete="off" >
                             </form>
                              </div>
                 </div>

             </div>
         </div>
         </div>

         <div class="border">

         </div>

     {% endif %}


     {% if mvsortie is defined %}
         <div class="row">
         <div class="col-lg-12">
         <div class="panel panel-default">
         <div class="panel-body">
         <div class="table-responsive" id="utilisateurs">
         <div class="card-body">
             <h5 class="card-title m-b-0">Mouvement sortie de Stock    {% if infomagasin  is defined  %}


                     {% for item in infomagasin %}
                         : {{ item.designation }}



                     {% endfor %}
                 {% endif %}</h5>
         </div>



       <table id="exemple4" class="table table-bordered table-hover table-striped display" >
             <thead class="table-info">
             <tr class="text-dark">
     <th>Réf Sortie</th>
                 <th>Date</th>
                 <th>Catégorie</th>
                 <th>Article</th>
                 <th>Unité</th>


                  {% if (is_granted('ROLE_ADMIN') or is_granted('ROLE_DIRECTEUR') )%}
                                              <th>Région</th>
                                                   {% endif %}
                                           {% if (is_granted('ROLE_ADMIN') or is_granted('ROLE_DIRECTEUR') )%}
                                              <th>Magasin</th>
                                                   {% endif %}
                 <th>Qté Sortie</th>

                 <th> Type repas</th>


             </tr>
             </thead>
             <tbody>
             {% for item in mvsortie %}



                 <tr>
  <td>Ref{{ item.sortie.refSortie }}ENT{{ item.sortie.dateSortie|date("Y") }}</td>
                     <td>{{ item.sortie.dateSortie|date("d/m/Y") }}</td>
                     <td>{{ item.article.categorie.nomCat }}</td>
                     <td>{{ item.article.nomArt }}</td>
                     <td>{{ item.article.unite }}</td>



                                {% if (is_granted('ROLE_ADMIN') or is_granted('ROLE_DIRECTEUR') )%}
                                              <td>{{ item.sortie.magasin.region.designation }}</td>
                                                   {% endif %}
                                              {% if (is_granted('ROLE_ADMIN') or is_granted('ROLE_DIRECTEUR') )%}
                                              <td>{{ item.sortie.magasin.designation }}</td>
                                                   {% endif %}


                     <td>{{ item.qtesortie|number_format(3) }}</td>
                     <td>{{ item.sortie.repas.designation }}</td>

                 </tr>

             {% endfor %}
             </tbody>
             <tfoot>
             <tr id="filters">

                 <th></th>
                 <th></th>
                 <th></th>
                 <th></th>
                 <th></th>
                    {% if (is_granted('ROLE_ADMIN') or is_granted('ROLE_DIRECTEUR') )%}
                     <th></th>
                 {% endif %}
                        {% if (is_granted('ROLE_ADMIN') or is_granted('ROLE_DIRECTEUR') )%}
                     <th></th>
                 {% endif %}
                 <th></th>
                 <th></th>

             </tr>

             </tfoot>
         </table>



             {% elseif  mventree is defined %}
             <div class="row">
                 <div class="col-lg-12">
                     <div class="panel panel-default">
                         <div class="panel-body">
                             <div class="table-responsive" id="utilisateurs">
                                 <div class="card-body">
                                     <h5 class="card-title m-b-0">Mouvement entrée en Stock    {% if infomagasin  is defined  %}


                                             {% for item in infomagasin %}
                                                 : {{ item.designation }}



                                             {% endfor %}
                                         {% endif %}</h5>
                                 </div>



                               <table id="exemple4" class="table table-bordered table-hover table-striped display" >
                                 <thead class="table-info">
                                 <tr class="text-dark">
                                  <th>Réf Entrée</th>
                                         <th>Date</th>
                                         <th>Catégorie</th>
                                         <th>Article</th>
                                         <th>Unité</th>


                                              {% if (is_granted('ROLE_ADMIN') or is_granted('ROLE_DIRECTEUR') )%}
                                              <th>Région</th>
                                                   {% endif %}
                                           {% if (is_granted('ROLE_ADMIN') or is_granted('ROLE_DIRECTEUR') )%}
                                              <th>Magasin</th>
                                                   {% endif %}
                                         <th>Qté entrée</th>

                                         <th> prix unitaire</th>
                                         <th> Total</th>

                                         <th>Fournisseur</th>

                                     </tr>
                                     </thead>
                                     <tbody>
                                     {% for item in mventree %}

                                         <tr>
                             <td>Ref{{ item.entree.refEntree }}ENT{{ item.entree.dateEntree|date("Y") }}</td>
                                             <td>{{ item.entree.dateEntree|date("d/m/Y") }}</td>

                                             <td>{{ item.article.categorie.nomCat }}</td>
                                             <td>{{ item.article.nomArt }}</td>
                                             <td>{{ item.article.unite }}</td>


                                                      {% if (is_granted('ROLE_ADMIN') or is_granted('ROLE_DIRECTEUR') )%}
                                              <td>{{ item.entree.magasin.region.designation }}</td>
                                                   {% endif %}
                                              {% if (is_granted('ROLE_ADMIN') or is_granted('ROLE_DIRECTEUR') )%}
                                              <td>{{ item.entree.magasin.designation }}</td>
                                                   {% endif %}


                                             <td>{{ item.qteentree|number_format(3) }}</td>
                                             <td>{{ item.prixentree|number_format(3) }}</td>
                                             <td>{{ (item.prixentree*item.qteentree)|number_format(3) }}</td>
                                             <td>{{ item.entree.commande.userfr.nomste }}</td>
                                         </tr>

                                     {% endfor %}
                                     </tbody>
                                     <tfoot>
                                     <tr id="filters">

                                         <th></th>
                                         <th></th>
                                         <th></th>
                                         <th></th>
                                         <th></th>
        {% if (is_granted('ROLE_ADMIN') or is_granted('ROLE_DIRECTEUR') )%}
                     <th></th>
                 {% endif %}
                        {% if (is_granted('ROLE_ADMIN') or is_granted('ROLE_DIRECTEUR') )%}
                     <th></th>
                 {% endif %}
                                         <th></th>
  <th >Total:</th>
                                         <th></th>

                                         <th></th>
                                     </tr>

                                     </tfoot>
                                 </table>

                                 {% else %}
                                     <div class="callout callout-info">
                                         <h5><i class="fas fa-info"></i> Note:</h5>
                                         Pas d'enregistrement.
                                     </div>
                                 {% endif %}
     </div>

     </div>


     </div>
     </div>
     </div><!--/.row-->


     </div>

     </div>


 #}




    {#{% if (is_granted('ROLE_ADMIN') or is_granted('ROLE_DIRECTEUR')  or  is_granted('ROLE_CHEFBUREAU') or   is_granted('ROLE_CHEFUNITE') or  is_granted('ROLE_MAGASINIER')  ) %}

     <div class="row">
           <div class="col-lg-12">

           <div class="card   card-outline ">
             <div class="card-header border  ">
               <h3 class="card-title">
                   <i class="fas fa-list"></i>
                  Mouvement des articles
               </h3>

               <div class="card-tools">
                   <button type="button" class="btn btn-tool" data-widget="maximize"><i class="fas fa-expand"></i>
                   </button>
               </div>

             <div class="card-body">
                       <!-- Main content -->
                       <section class="content">
                           <div class="container-fluid">
                               <div class="card   card-outline">
                                   <div class="card-header border  bglightblue">
                                       <h3 class="card-title">
                                           <i class="fas fa-list"></i>
                                           Recherche par date

                                       </h3>
                                       <div class="card-tools">
                                           <button type="button" class="btn btn-tool" data-widget="collapse">
                                               <i class="fas fa-minus"></i>
                                           </button>
                                           <button type="button" class="btn btn-tool" data-widget="maximize"><i
                                                       class="fas fa-expand"></i>
                                           </button>
                                           <button type="button" class="btn btn-tool" data-widget="remove">
                                               <i class="fas fa-times"></i>
                                           </button>
                                       </div>
                                   </div> <!-- /.card-body -->
                                   <div class="card-body">

                                       <form class="form-horizontal" method="post">

                                           <div class="row">

                                               <div class="form-group col-md-3">
                                                   <label>Date début: </label>

                                                   <div class="input-group   ">
                                                       <input class="form-control form-control-sm" name="min"
                                                              placeholder="dd/mm/yyyy"
                                                              id="min" type="text"
                                                              autocomplete="off" data-inputmask="'alias': 'dd/mm/yyyy'">
                                                       <div class="input-group-prepend">
                                                           #}{#  <span class="input-group-text">

                                                          <img src="../../plugins/jquery-ui/img/calendar-blue.gif">
                                                         </span>#}{#
                                                       </div>
                                                   </div>
                                               </div>
                                               <div class="form-group col-md-3">

                                                   <label>Date fin: </label>

                                                   <div class="input-group">
                                                       <input class="form-control form-control-sm" name="max"
                                                              placeholder="dd/mm/yyyy"
                                                              id="max" type="text"
                                                              autocomplete="off" data-inputmask="'alias': 'dd/mm/yyyy'">
                                                       <div class="input-group-prepend">
                                                           #}{#      <span class="input-group-text ">

                                                                  <img src="../../plugins/jquery-ui/img/calendar-blue.gif">
                                                             </span>#}{#

                                                       </div>
                                                   </div>
                                               </div>
                                           </div>

                                       </form>
                                   </div><!-- /.card-body -->
                               </div>
                           </div><!-- /.container-fluid -->
                       </section>

          #}{# <div class="border">

           </div>#}{#

       {% endif %}


       {% if mvsortie is defined %}
           <div class="row">
           <div class="col-lg-12">
           <div class="panel panel-default">
           <div class="panel-body">
           <div class="table-responsive" id="utilisateurs">
           <div class="card-body">
               <h5 class="card-title m-b-0">Mouvement sortie de Stock    {% if infomagasin  is defined  %}


                       {% for item in infomagasin %}
                           : {{ item.designation }}



                       {% endfor %}
                   {% endif %}</h5>
           </div>



         <table id="exemple4" class="table table-bordered table-hover table-striped display" >
               <thead class="table-info">
               <tr class="text-dark">
       <th>Réf Sortie</th>
                   <th>Date</th>
                   <th>Catégorie</th>
                   <th>Article</th>
                   <th>Unité</th>


                    {% if (is_granted('ROLE_ADMIN') or is_granted('ROLE_DIRECTEUR') )%}
                                                <th>Région</th>
                                                     {% endif %}
                                             {% if (is_granted('ROLE_ADMIN') or is_granted('ROLE_DIRECTEUR') )%}
                                                <th>Magasin</th>
                                                     {% endif %}
                   <th>Qté Sortie</th>

                   <th> Type repas</th>


               </tr>
               </thead>
               <tbody>
               {% for item in mvsortie %}



                   <tr>
    <td>Ref{{ item.sortie.refSortie }}ENT{{ item.sortie.dateSortie|date("Y") }}</td>
                       <td>{{ item.sortie.dateSortie|date("d/m/Y") }}</td>
                       <td>{{ item.article.categorie.nomCat }}</td>
                       <td>{{ item.article.nomArt }}</td>
                       <td>{{ item.article.unite }}</td>



                                  {% if (is_granted('ROLE_ADMIN') or is_granted('ROLE_DIRECTEUR') )%}
                                                <td>{{ item.sortie.magasin.region.designation }}</td>
                                                     {% endif %}
                                                {% if (is_granted('ROLE_ADMIN') or is_granted('ROLE_DIRECTEUR') )%}
                                                <td>{{ item.sortie.magasin.designation }}</td>
                                                     {% endif %}


                       <td>{{ item.qtesortie|number_format(3) }}</td>
                       <td>{{ item.sortie.repas.designation }}</td>

                   </tr>

               {% endfor %}
               </tbody>
               <tfoot>
               <tr id="filters">

                   <th></th>
                   <th></th>
                   <th></th>
                   <th></th>
                   <th></th>
                      {% if (is_granted('ROLE_ADMIN') or is_granted('ROLE_DIRECTEUR') )%}
                       <th></th>
                   {% endif %}
                          {% if (is_granted('ROLE_ADMIN') or is_granted('ROLE_DIRECTEUR') )%}
                       <th></th>
                   {% endif %}
                   <th></th>
                   <th></th>

               </tr>

               </tfoot>
           </table>



               {% elseif  mventree is defined %}
             #}{#  <div class="row">
                   <div class="col-lg-12">
                       <div class="panel panel-default">
                           <div class="panel-body">#}{#



                             <section class="content">
                           <div class="container-fluid">
                               <div class="card card-outline  ">
                                   <div class="card-header border-0 bgmoccasin">
                                       <h3 class="card-title">
                                           <i class="fas fa-edit"></i>
                                           Liste des Sorties

                                       </h3>
                                       <div class="card-tools">
                                           <button type="button" class="btn btn-tool" data-widget="collapse">
                                               <i class="fas fa-minus"></i>
                                           </button>
                                           <button type="button" class="btn btn-tool" data-widget="maximize"><i
                                                       class="fas fa-expand"></i>
                                           </button>
                                           <button type="button" class="btn btn-tool" data-widget="remove">
                                               <i class="fas fa-times"></i>
                                           </button>
                                       </div>
                                   </div>


                               <div class="table-responsive" id="utilisateurs">
                                   <div class="card-body">
                                       <h5 class="card-title m-b-0">Mouvement entrée en Stock    {% if infomagasin  is defined  %}


                                               {% for item in infomagasin %}
                                                   : {{ item.designation }}



                                               {% endfor %}
                                           {% endif %}</h5>
                                   </div>



                                 <table id="exemple4" class="table table-bordered table-hover table-striped display" >
                                   <thead class="table-info">
                                   <tr class="text-dark">
                                    <th>Réf Entrée</th>
                                           <th>Date</th>
                                           <th>Catégorie</th>
                                           <th>Article</th>
                                           <th>Unité</th>


                                                {% if (is_granted('ROLE_ADMIN') or is_granted('ROLE_DIRECTEUR') )%}
                                                <th>Région</th>
                                                     {% endif %}
                                             {% if (is_granted('ROLE_ADMIN') or is_granted('ROLE_DIRECTEUR') )%}
                                                <th>Magasin</th>
                                                     {% endif %}
                                           <th>Qté entrée</th>

                                           <th> prix unitaire</th>
                                           <th> Total</th>

                                           <th>Fournisseur</th>

                                       </tr>
                                       </thead>
                                       <tbody>
                                       {% for item in mventree %}

                                           <tr>
                               <td>Ref{{ item.entree.refEntree }}ENT{{ item.entree.dateEntree|date("Y") }}</td>
                                               <td>{{ item.entree.dateEntree|date("d/m/Y") }}</td>

                                               <td>{{ item.article.categorie.nomCat }}</td>
                                               <td>{{ item.article.nomArt }}</td>
                                               <td>{{ item.article.unite }}</td>


                                                        {% if (is_granted('ROLE_ADMIN') or is_granted('ROLE_DIRECTEUR') )%}
                                                <td>{{ item.entree.magasin.region.designation }}</td>
                                                     {% endif %}
                                                {% if (is_granted('ROLE_ADMIN') or is_granted('ROLE_DIRECTEUR') )%}
                                                <td>{{ item.entree.magasin.designation }}</td>
                                                     {% endif %}


                                               <td>{{ item.qteentree|number_format(3) }}</td>
                                               <td>{{ item.prixentree|number_format(3) }}</td>
                                               <td>{{ (item.prixentree*item.qteentree)|number_format(3) }}</td>
                                               <td>{{ item.entree.commande.userfr.nomste }}</td>
                                           </tr>

                                       {% endfor %}
                                       </tbody>
                                       <tfoot>
                                       <tr id="filters">

                                           <th></th>
                                           <th></th>
                                           <th></th>
                                           <th></th>
                                           <th></th>
          {% if (is_granted('ROLE_ADMIN') or is_granted('ROLE_DIRECTEUR') )%}
                       <th></th>
                   {% endif %}
                          {% if (is_granted('ROLE_ADMIN') or is_granted('ROLE_DIRECTEUR') )%}
                       <th></th>
                   {% endif %}
                                           <th></th>
    <th >Total:</th>
                                           <th></th>

                                           <th></th>
                                       </tr>

                                       </tfoot>
                                   </table>

                                   {% else %}
                                       <div class="callout callout-info">
                                           <h5><i class="fas fa-info"></i> Note:</h5>
                                           Pas d'enregistrement.
                                       </div>
                                   {% endif %}
       </div>

       </div>


       </div>
       </section>
       </div>
       </div><!--/.row-->


       </div>

       </div>
   #}






    <!-- //////////////////////////////////////////////// -->





    <!-- Main content -->
    <section class="content">
        <div class="container-fluid">
            <!-- COLOR PALETTE -->

            {#
                        {% if sorties %}
            #}

            <div class="card card-default color-palette-box bgpowderblue ">
                <div class="card-header border  bgdarkseagreen">
                    <h3 class="card-title">
                        <i class="fas fa-tag"></i>
                        Mouvement des articles {% if infomagasin  is defined %}
                            {% for item in infomagasin %}
                                : {{ item.designation }}
                            {% endfor %}
                        {% endif %}
                    </h3>
                    <div class="card-tools">
                        <button type="button" class="btn btn-tool" data-widget="maximize"><i class="fas fa-expand"></i>
                        </button>
                    </div>
                </div>


                <div class="card-body">
                    <!-- Main content -->
                    <section class="content">
                        <div class="container-fluid">
                            <div class="card   card-outline">
                                <div class="card-header border  bglightblue">
                                    <h3 class="card-title">
                                        <i class="fas fa-list"></i>
                                        Recherche par date

                                    </h3>
                                    <div class="card-tools">
                                        <button type="button" class="btn btn-tool" data-widget="collapse">
                                            <i class="fas fa-minus"></i>
                                        </button>
                                        <button type="button" class="btn btn-tool" data-widget="maximize"><i
                                                    class="fas fa-expand"></i>
                                        </button>
                                        <button type="button" class="btn btn-tool" data-widget="remove">
                                            <i class="fas fa-times"></i>
                                        </button>
                                    </div>
                                </div> <!-- /.card-body -->
                                <div class="card-body">

                                    <form class="form-horizontal" method="post">

                                        <div class="row">

                                            <div class="form-group col-md-3">
                                                <label>Date début: </label>

                                                <div class="input-group   ">
                                                    <input class="form-control form-control-sm" name="min"
                                                           placeholder="dd/mm/yyyy"
                                                           id="min" type="text"
                                                           autocomplete="off" data-inputmask="'alias': 'dd/mm/yyyy'">
                                                    <div class="input-group-prepend">
                                                        {#  <span class="input-group-text">

                                                       <img src="../../plugins/jquery-ui/img/calendar-blue.gif">
                                                      </span>#}
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="form-group col-md-3">

                                                <label>Date fin: </label>

                                                <div class="input-group">
                                                    <input class="form-control form-control-sm" name="max"
                                                           placeholder="dd/mm/yyyy"
                                                           id="max" type="text"
                                                           autocomplete="off" data-inputmask="'alias': 'dd/mm/yyyy'">
                                                    <div class="input-group-prepend">
                                                        {#      <span class="input-group-text ">

                                                               <img src="../../plugins/jquery-ui/img/calendar-blue.gif">
                                                          </span>#}

                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </form>
                                </div><!-- /.card-body -->
                            </div>
                        </div><!-- /.container-fluid -->
                    </section>
                    <!-- /.content -->

                    <!-- Main content -->
                    <section class="content">
                        <div class="container-fluid">
                            <div class="card card-outline  ">
                                <div class="card-header border-0 bgmoccasin">
                                    <h3 class="card-title">
                                        <i class="fas fa-edit"></i>

                                        {% if mvsortie is defined %}
                                            Liste des articles en sortie
                                        {% elseif  mventree is defined %}
                                            Liste des articles en entrée
                                        {% endif %}

                                    </h3>
                                    <div class="card-tools">
                                        <button type="button" class="btn btn-tool" data-widget="collapse">
                                            <i class="fas fa-minus"></i>
                                        </button>
                                        <button type="button" class="btn btn-tool" data-widget="maximize"><i
                                                    class="fas fa-expand"></i>
                                        </button>
                                        <button type="button" class="btn btn-tool" data-widget="remove">
                                            <i class="fas fa-times"></i>
                                        </button>
                                    </div>
                                </div> <!-- /.card-body -->
                                <div class="card-body">
                                    <div class="card-body table-responsive p-0 " id="entrees">
                                        {% if mvsortie is defined %}

                                        {% if mvsortie %}
                                            <table id="exemple4"
                                                   class="table table-bordered table-hover table-striped display">
                                                <thead class="table-info">
                                                <tr class="text-dark">
                                                    <th>Réf Sortie</th>
                                                    <th>Date</th>
                                                    <th>Catégorie</th>
                                                    <th>Article</th>
                                                    <th>Unité</th>


                                                    {% if (is_granted('ROLE_ADMIN') or is_granted('ROLE_DIRECTEUR') ) %}
                                                        <th>Région</th>
                                                    {% endif %}
                                                    {% if (is_granted('ROLE_ADMIN') or is_granted('ROLE_DIRECTEUR') ) %}
                                                        <th>Magasin</th>
                                                    {% endif %}
                                                    <th>Qté Sortie</th>
                                                    <th> Type repas</th>
                                                </tr>
                                                </thead>
                                                <tbody>
                                                {% for item in mvsortie %}
                                                    <tr>
                                                        <td>Ref{{ item.sortie.refSortie }}SRT{{item.sortie.anneeScolaire.designation }}</td>
                                                        <td>{{ item.sortie.dateSortie|date("d/m/Y") }}</td>
                                                        <td>{{ item.article.categorie.nomCat }}</td>
                                                        <td>{{ item.article.nomArt }}</td>
                                                        <td>{{ item.article.unite }}</td>
                                                        {% if (is_granted('ROLE_ADMIN') or is_granted('ROLE_DIRECTEUR') ) %}
                                                            <td>{{ item.sortie.magasin.region.designation }}</td>
                                                        {% endif %}
                                                        {% if (is_granted('ROLE_ADMIN') or is_granted('ROLE_DIRECTEUR') ) %}
                                                            <td>{{ item.sortie.magasin.designation }}</td>
                                                        {% endif %}
                                                        <td>{{ item.qtesortie|number_format(3) }}</td>
                                                        <td>{{ item.sortie.repas.designation }}</td>
                                                    </tr>
                                                {% endfor %}
                                                </tbody>
                                                <tfoot>
                                                <tr id="filters">
                                                    <th></th>
                                                    <th></th>
                                                    <th></th>
                                                    <th></th>
                                                    <th></th>
                                                    {% if (is_granted('ROLE_ADMIN') or is_granted('ROLE_DIRECTEUR') ) %}
                                                        <th></th>
                                                    {% endif %}
                                                    {% if (is_granted('ROLE_ADMIN') or is_granted('ROLE_DIRECTEUR') ) %}
                                                        <th></th>
                                                    {% endif %}
                                                    <th></th>
                                                    <th></th>
                                                </tr>

                                                </tfoot>
                                            </table>
                                        {% else %}
                                            <div>
                                                <br>
                                            </div>
                                            <div class="callout callout-info">
                                                <h5><i class="fas fa-info"></i> Note:</h5>
                                                Pas d'enregistrement.
                                            </div>
                                        {% endif %}

                                        {% elseif  mventree is defined %}

                                        {% if mventree %}
                                        <table id="exemple4"
                                               class="table table-bordered table-hover table-striped display">
                                            <thead class="table-info">
                                            <tr class="text-dark">
                                                <th>Réf Entrée</th>
                                                <th>Date</th>
                                                <th>Catégorie</th>
                                                <th>Article</th>
                                                <th>Unité</th>
                                                {% if (is_granted('ROLE_ADMIN') or is_granted('ROLE_DIRECTEUR') ) %}
                                                    <th>Région</th>
                                                {% endif %}
                                                {% if (is_granted('ROLE_ADMIN') or is_granted('ROLE_DIRECTEUR') ) %}
                                                    <th>Magasin</th>
                                                {% endif %}
                                                <th>Qté entrée</th>
                                                <th> prix unitaire</th>
                                                <th> Total</th>
                                                <th>Fournisseur</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            {% for item in mventree %}

                                                <tr>
                                                    <td>Ref{{ item.entree.refEntree }}ENT{{ item.entree.anneeScolaire.designation }}</td>
                                                    <td>{{ item.entree.dateEntree|date("d/m/Y") }}</td>

                                                    <td>{{ item.article.categorie.nomCat }}</td>
                                                    <td>{{ item.article.nomArt }}</td>
                                                    <td>{{ item.article.unite }}</td>
                                                    {% if (is_granted('ROLE_ADMIN') or is_granted('ROLE_DIRECTEUR') ) %}
                                                        <td>{{ item.entree.magasin.region.designation }}</td>
                                                    {% endif %}
                                                    {% if (is_granted('ROLE_ADMIN') or is_granted('ROLE_DIRECTEUR') ) %}
                                                        <td>{{ item.entree.magasin.designation }}</td>
                                                    {% endif %}
                                                    <td>{{ item.qteentree|number_format(3) }}</td>
                                                    <td>{{ item.prixentree|number_format(3) }}</td>
                                                    <td>{{ (item.prixentree*item.qteentree)|number_format(3) }}</td>
                                                    <td>{{ item.entree.commande.userfr.nomste }}</td>
                                                </tr>

                                            {% endfor %}
                                            </tbody>
                                            <tfoot>
                                            <tr id="filters">
                                                <th></th>
                                                <th></th>
                                                <th></th>
                                                <th></th>
                                                <th></th>
                                                {% if (is_granted('ROLE_ADMIN') or is_granted('ROLE_DIRECTEUR') ) %}
                                                    <th></th>
                                                {% endif %}
                                                {% if (is_granted('ROLE_ADMIN') or is_granted('ROLE_DIRECTEUR') ) %}
                                                    <th></th>
                                                {% endif %}
                                                <th></th>
                                                <th>Total:</th>
                                                <th></th>
                                                <th></th>
                                            </tr>

                                            </tfoot>
                                        </table>

                                        {% else %}
                                            <div>
                                                <br>
                                            </div>
                                            <div class="callout callout-info">
                                                <h5><i class="fas fa-info"></i> Note:</h5>
                                                Pas d'enregistrement....
                                            </div>
                                        {% endif %}


                                    </div>
                                 {#   {% else %}
                                        <div>
                                            <br>
                                        </div>
                                        <div class="callout callout-info">
                                            <h5><i class="fas fa-info"></i> Note:</h5>
                                            Pas d'enregistrement.
                                        </div>#}

                                    {% endif %}
                                    <div>
                                        <br>
                                    </div>


                                </div><!-- /.card-body -->
                            </div>
                        </div><!-- /.container-fluid -->
                    </section>
                    <!-- /.content -->

                </div>

            </div>

            <!-- /.card-body -->
        </div>
    </section>



{% endblock %}
{% block javascripts %}


    {#<script type="text/javascript" src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>


    <script type="https://code.jquery.com/jquery-3.3.1.js"></script>#}
    <script>

        $(document).ready(function () {
            $.fn.dataTable.ext.search.push(
                function (settings, data, dataIndex) {
                    var min = $('#min').datepicker("getDate");
                    //   alert(min);
                    var max = $('#max').datepicker("getDate");
                    // alert(max);
                    //    var startDate = new Date(data[1]);
                    // alert(startDate);


                    //     var dateString = "23/10/2015"; // Oct 23

                    var dateParts = data[1].split("/");

// month is 0-based, that's why we need dataParts[1] - 1
                    var startDate = new Date(+dateParts[2], dateParts[1] - 1, +dateParts[0]);

                    // alert(startDate);


                    if (min == null && max == null) {
                        return true;
                    }
                    if (min == null && startDate <= max) {
                        return true;
                    }
                    if (max == null && startDate >= min) {
                        return true;
                    }
                    if (startDate <= max && startDate >= min) {
                        return true;
                    }
                    return false;
                }
            );


            $("#min").datepicker({
                dateFormat: "dd/mm/yy",

                showOn: "button",
                showAnim: 'slideDown',
                showButtonPanel: true,
                autoSize: true,

                // buttonImageOnly: true,
                // buttonText: "...",
                buttonImage: "../../plugins/jquery-ui/img/calendar-blue.gif",
                closeText: "Vider",


                onSelect: function () {
                    table.draw();
                },
                changeMonth: true,
                changeYear: true


            });


            $("#max").datepicker({
                dateFormat: "dd/mm/yy",
                showOn: "button",
                showAnim: 'slideDown',
                showButtonPanel: true,
                autoSize: true,

                buttonImage: "../../plugins/jquery-ui/img/calendar-blue.gif",
                closeText: "Vider",
                onSelect: function () {
                    table.draw();
                },
                changeMonth: true,
                changeYear: true
            });


            var table = $('#exemple4').DataTable();

            $(document).on("click", ".ui-datepicker-close", function () {
                $('#max').val("")
                table.draw();
            });

            $(document).on("click", ".ui-datepicker-close", function () {
                $('#min').val("")
                table.draw();
            });

            // Event listener to the two range filtering inputs to redraw on input
            $('#min, #max').change(function () {
                table.draw();
            });
        });


    </script>


{% endblock %}